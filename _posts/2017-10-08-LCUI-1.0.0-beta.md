---
title: LCUI 1.0 Beta 开发日志
repo: lc-soft/LCUI
milestone: 4
---
## 2017-01-09
LCUI_StyleValue 枚举中的值有点多，有的值感觉没必要加上，应该按类别再拆分出来。

## 2017-12-25
为 block 显示方式加个规则：

- 当父级部件为 block，且有一个父部件的尺寸是固定的（如：100%，100px），则该部件的默认尺寸为父级部件内容框的尺寸。
- 当父级部件的尺寸都是非固定的尺寸，那么将该部件视为 inline-block 显示方式处理，根据内容尺寸计算自身尺寸。

有个情况需要考虑到，下拉菜单里的菜单项都是 100% 宽度，菜单宽度为自动，需要让计算出来的宽度为宽度最长的菜单项宽度，之前的实现方法是先让菜单项按 block 方式计算宽度，这时结果会是 0，然后按 inline-block 方式计算宽度，等所有菜单项宽度计算完后，菜单会重新计算宽度，并让菜单项再次更新宽度，这时菜单项的宽度都是菜单的内容框宽度。

## 2017-12-24
当一个 textview 部件显示方式为 block 时，没法撑开 inline-block 显示方式的父级部件，因为计算宽度时是根据父部件宽度计算的，初始状态父部件宽度会为 0，这是个问题。浏览器的处理虽然是 0，但它是默认不隐藏溢出内容的，所以子级元素只要尺寸大于 0 时也会显示。

## 2017-12-23
加个规则：计算部件内容宽度时，如果子部件的宽度为百分比单位，则忽略该部件。计算高度时也同理。

## 2017-12-19
实现 flex 布局前需要调研一下 `display: flex` 和 `display: block` 有哪些差异，毕竟现有的布局和尺寸计算都只考虑到 inline-block 和 block。当前版本只需要实现 justify-content 属性的功能，如果 flex 和 block 这两种显示方式没多大差异的话，那在计算部件尺寸时可以暂时将它视为 block 显示方式来处理。

## 2017-12-17
测试模态弹框（Modal）时出现了个奇怪的问题，只显示了背景黑幕，而窗口并未显示，把窗口背景色设为纯色也看不到。经调试发现模态窗口居然显示在正文底下，看上去是显示顺序未被更新。模态窗口的结点在显示时会从原来的地方移动到根结点上，估计是在移动结点后它的部分样式被判断为不需要更新，解决方法就是在移动结点后清空部件当前样式，重新计算。

## 2017-12-01
考虑到以后要添加伪类选择器、属性选择器、子元素选择器等，需要改进现有的 CSS 样式表的查询方式。目前只是把 disabled、active、hover、first-child、last-child 这些伪类存放在 status 中，查询样式表时把它们加入匹配条件里，生成一堆可能的选择器再去匹配样式表，一旦遇到 nth-child()、[class="col-*"] 这类需要实时计算条件的选择器就无能为力了。

## 2017-11-25
感觉 @font-face 中的参数只有 src 有用，目前的需求只是需要靠 css 代码来载入字体，像 font-family、font-weight、font-style 属性都可以从字体文件中读取，没多大必要去设置。根据 CSS 文档中对 @font-face 的解释，这些属性貌似可以重新定义字体信息？

## 2017-11-20
开始添加 @font-face 规则解析器，现有的 CSS 解析器代码需要做些调整，方便以后添加 @media、@import、 @charset 这些规则。解析得到的 @font-face 规则数据可以靠回调函数来接收。

## 2017-11-18
选择器名称相同的多张样式表都是放在同一块地方，批次号为第一次创建选择器时的批次号，这个批次号主要用来决定样式表的权重，由于批次号都一样，在合并样式表时会出现一些问题，例如：

``` css
.name, .myname {
  display: inline-block;
}
.myname {
  width: 100px;
}
.name {
  width: 64px;
}
```

`.name` 第一次出现在 `.myname` 前面，它的批次号是 1，然而在 `.myname` 后面的 `.name` 的批次号也依然是 1，在取 `.name.myname` 的样式表时， `.name` 在后面的样式并未覆盖到 `.myname` 的样式，导致 width 的值为 100px，效果等同于：

``` css
.name {
  width: 64px;
  display: inline-block;
}
.myname {
  display: inline-block;
}
.myname {
  width: 100px;
}
```



## 2017-11-02
滚动条用起来很麻烦，需要手动指定滚动层和父容器，而滚动层还要手动加上 scrolllayer 类，应该做些调整，不指定这两个元素，就默认将上一个元素作为滚动层，父元素作为父容器，并为滚动层自动添加 scrolllayer 类。

添加了按钮的 css，效果如下图所示：

[![](/static/images/devlog/buttons-example.gif "Buttons example")](/static/images/devlog/buttons-example.gif)

## 2017-10-08
准备开发 CSS 框架，主要功能实现可以参考 [Bootstrap](http://getbootstrap.com/)，项目的构建工具基于 NodeJS 运行时，CSS 预处理器、字体图标等资源可以直接用 npm install 命令安装，使用起来也很方便。框架的文档可以做成 LCUI 应用程序，运行它就能体验实际效果。等第一个版本完成后可以应用到 LC-Finder 的新版本中。
