---
title: LCFinder 0.5.0 开发日志
repo: lc-soft/LC-Finder
toc: true
categories:
  - 开发日志
  - LCFinder
---

开发计划：

- 更新 UI
- 优化性能
- 优化内存占用
- 重构图片查看器组件
- 重构缩略图列表组件
- 改用 lcui-cli 管理翻译文本
- 添加测试用例
- 完善 CI 脚本

<!-- more -->
## 2020-10-08

缩略图列表组件存在内存泄漏问题，禁止加载缩略图后也有 100MB 以上的内存占用，除去已知的 30MB 左右的样式表和字体缓存占用，剩下的内存如果都是部件数据占用的话，那得考虑再优化一次部件的数据结构了。之前定位的泄漏原因是 unqlite 数据库的缓存机制，它会在内存中缓存用到的数据，读写的数据增多缓存也会越大，但现在用的是 leveldb 数据库，暂不知道它是不是也有相同得机制。

现有的缩略图加载功能的实现代码有些复杂，懒得再改老代码了，准备重写它，在开始之前先整理一遍需求：

- 缩略图加载频率控制方式由防抖（debounce）改成节流（throttle），以让第一批缩略图尽早呈现
- 缩略图的加载和卸载需要考虑到部件得生命周期，避免在切换目录时因部件已经销毁而导致内存访问越界问题
